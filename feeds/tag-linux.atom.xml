<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>mx's blog</title><link href="http://x-wei.github.io/" rel="alternate"></link><link href="http://x-wei.github.io/feeds/tag-linux.atom.xml" rel="self"></link><id>http://x-wei.github.io/</id><updated>2015-09-27T00:00:00+02:00</updated><entry><title>linux系统添加swap分区&amp;调整swapness</title><link href="http://x-wei.github.io/linux-swap.html" rel="alternate"></link><published>2015-09-27T00:00:00+02:00</published><author><name>mx</name></author><id>tag:x-wei.github.io,2015-09-27:linux-swap.html</id><summary type="html">&lt;p&gt;当年装mint 17.1的时候心想我的电脑有4GB内存怎么可能不够用, 于是果断没有分一个swap分区, 呵呵...   &lt;/p&gt;
&lt;p&gt;然后就看到chrome这几年来吃内存越来越严重, 导致我开多几个标签页再开eclipse的话电脑就很有可能直接卡死... 郁闷啊 ! 于是决定给系统增加一个swap分区. 之前给&lt;a href="http://thealternative.ch/index.php?view=linuxdays"&gt;thealternative&lt;/a&gt;写邮件询问这件事, Sandro Kalbermatter同学热情回复了我告诉我怎么做, 按照他说的果然成功了, 特此一记.    &lt;/p&gt;
&lt;h2 id="step1-swap"&gt;step1. 建立swap分区&lt;/h2&gt;
&lt;p&gt;首先, 用gparted调整磁盘分区, 缩小一个磁盘的大小, 然后用空出来的空间新建一个swap分区.    &lt;/p&gt;
&lt;p&gt;关于swap分区应该多大, 根据&lt;a href="http://www.linux.com/news/software/applications/8208-all-about-linux-swap-space"&gt;这个帖子&lt;/a&gt;, 大约是内存的2-3倍, 不过我只是分了和内存一样大的4G空间, 感觉这样应该够用了(吧).   &lt;/p&gt;
&lt;p&gt;我是把存放文件的500G分区缩小, 这个过程会比较慢, 大概二十多分钟以后才结束:  &lt;br/&gt;
&lt;img alt="" class="img-responsive" src="../images/linux-swap/pasted_image.png"/&gt; &lt;/p&gt;
&lt;h2 id="step2-fstab"&gt;step2. 编辑fstab&lt;/h2&gt;
&lt;p&gt;建立好了swap分区以后, 打开终端, 输入&lt;code&gt;sudo blkid&lt;/code&gt;查看所有的磁盘分区.    &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;$ sudo blkid   &lt;/span&gt;
&lt;span class="code-line"&gt;/dev/sda1: &lt;span class="nv"&gt;LABEL&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"FILES"&lt;/span&gt; &lt;span class="nv"&gt;UUID&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"ddefc0a7-30a1-42fb-a71a-0aebb55cb0b3"&lt;/span&gt; &lt;span class="nv"&gt;TYPE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"ext2"&lt;/span&gt;    &lt;/span&gt;
&lt;span class="code-line"&gt;/dev/sda2: &lt;span class="nv"&gt;UUID&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"952b70b9-c7ee-4adf-9ceb-ac631ed8d7eb"&lt;/span&gt; &lt;span class="nv"&gt;TYPE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"swap"&lt;/span&gt;    &lt;/span&gt;
&lt;span class="code-line"&gt;/dev/sdb1: &lt;span class="nv"&gt;LABEL&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"WIN7"&lt;/span&gt; &lt;span class="nv"&gt;UUID&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"D268862068860407"&lt;/span&gt; &lt;span class="nv"&gt;TYPE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"ntfs"&lt;/span&gt;    &lt;/span&gt;
&lt;span class="code-line"&gt;/dev/sdb5: &lt;span class="nv"&gt;UUID&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"0ee51625-2fe3-49c8-b388-53076bce7955"&lt;/span&gt; &lt;span class="nv"&gt;TYPE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"ext4"&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;然后看到了swap分区的UUID以后, 将其复制, 然后编辑fstab文件: &lt;code&gt;sudo leafpad /etc/fstab&lt;/code&gt;:   &lt;/p&gt;
&lt;p&gt;&lt;code&gt;UUID=put-the-uud-here       none            swap            defaults  0 0&lt;/code&gt; &lt;/p&gt;
&lt;p&gt;然后重启, 就可以看到swap分区了!  &lt;br/&gt;
&lt;img alt="" class="img-responsive" src="../images/linux-swap/pasted_image001.png"/&gt; &lt;/p&gt;
&lt;h2 id="step3-swapness"&gt;step3. 调整swapness&lt;/h2&gt;
&lt;p&gt;&lt;a href="http://askubuntu.com/questions/103915/how-do-i-configure-swappiness"&gt;swapness&lt;/a&gt;是一个在0到100之间的数, 当系统的内存剩余不到百分之swapness的时候, 开始使用swap分区. 默认的系统swapness是60, 就是内存占用超过40%的时候就开始使用swap分区了.    &lt;/p&gt;
&lt;p&gt;使用&lt;code&gt;cat /proc/sys/vm/swappiness&lt;/code&gt;可以查看当前的swapness.    &lt;/p&gt;
&lt;p&gt;由于内存读写要比swap分区快很多, 在内存足够的情况下完全没有必要使用swap, 于是修改swapness为20:    &lt;/p&gt;
&lt;p&gt;&lt;code&gt;sudo leafpaf /etc/sysctl.conf&lt;/code&gt; &lt;/p&gt;
&lt;p&gt;在文件里加入一行: &lt;code&gt;vm.swappiness = 10&lt;/code&gt; &lt;/p&gt;
&lt;p&gt;重启即可...   &lt;/p&gt;</summary><category term="linux"></category></entry><entry><title>Linux下pdf文件的压缩与合并</title><link href="http://x-wei.github.io/Linux%E4%B8%8Bpdf%E6%96%87%E4%BB%B6%E7%9A%84%E5%8E%8B%E7%BC%A9%E4%B8%8E%E5%90%88%E5%B9%B6.html" rel="alternate"></link><published>2014-10-29T00:00:00+01:00</published><author><name>mx</name></author><id>tag:x-wei.github.io,2014-10-29:Linux下pdf文件的压缩与合并.html</id><summary type="html">&lt;h2 id="pdf"&gt;压缩pdf&lt;/h2&gt;
&lt;p&gt;用&lt;code&gt;convert&lt;/code&gt; 只简单指定resize好像不太好使: &lt;/p&gt;
&lt;p&gt;&lt;code&gt;convert -resize 50% input.pdf out.pdf&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;用&lt;code&gt;gs&lt;/code&gt;(&lt;a href="http://blog.sciencenet.cn/blog-467089-773990.html"&gt;http://blog.sciencenet.cn/blog-467089-773990.html&lt;/a&gt;):&lt;/p&gt;
&lt;p&gt;&lt;code&gt;gs -sDEVICE=pdfwrite -dCompatibilityLevel=1.4 -dPDFSETTINGS=/screen -dNOPAUSE -dQUIET -dBATCH -sOutputFile=out.pdf input.pdf&lt;/code&gt; &lt;/p&gt;
&lt;p&gt;后来发现老是compress以后的结果不好, 看到&lt;a href="http://superuser.com/questions/427851/batch-resize-and-compress-pdf-files"&gt;这篇帖子&lt;/a&gt;发现&lt;strong&gt;convert有好多选项&lt;/strong&gt;. 最后实验下来这样convert的效果很好, 既能压缩文件, 又保证了压缩后还足够清楚:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;convert -density 200 -compress jpeg input.pdf out.pdf&lt;/code&gt;&lt;/p&gt;
&lt;h2 id="pdf_1"&gt;合并pdf&lt;/h2&gt;
&lt;p&gt;之前&lt;a href="http://x-wei.github.io/%E5%9B%BE%E7%89%87%E5%90%88%E5%B9%B6%E4%B8%BApdf,%20%E5%90%88%E5%B9%B6mp3,%20%E6%89%B9%E9%87%8F%E5%8E%8B%E7%BC%A9%E5%9B%BE%E7%89%87.html"&gt;博客&lt;/a&gt;写过, 用pdfjoin: &lt;/p&gt;
&lt;p&gt;&lt;code&gt;pdfjoin $(ls *.pdf|sort -n) --outfile out.pdf&lt;/code&gt;&lt;/p&gt;</summary><category term="linux"></category></entry><entry><title>多张图片合并为pdf, 合并mp3, 批量压缩图片</title><link href="http://x-wei.github.io/%E5%9B%BE%E7%89%87%E5%90%88%E5%B9%B6%E4%B8%BApdf,%20%E5%90%88%E5%B9%B6mp3,%20%E6%89%B9%E9%87%8F%E5%8E%8B%E7%BC%A9%E5%9B%BE%E7%89%87.html" rel="alternate"></link><published>2012-11-16T19:47:00+01:00</published><author><name>mx</name></author><id>tag:x-wei.github.io,2012-11-16:图片合并为pdf, 合并mp3, 批量压缩图片.html</id><summary type="html">&lt;p&gt;前一阵遇到的三个小功能, linux下有简单的命令可以实现...&lt;/p&gt;
&lt;h2 id="pdf"&gt;多张图片合并为pdf&lt;/h2&gt;
&lt;p&gt;这个在网上搜一般找到的结果是:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;convert *.jpg xx.pdf&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;但是这么做的问题是, 运行起来超级慢, 电脑直接卡死!!!&lt;/p&gt;
&lt;p&gt;后来看了&lt;a href="http://pityonline.info/2009/12/%E7%BB%88%E4%BA%8E%E6%90%9E%E5%AE%9A%E4%BA%86%E5%A4%9A%E5%BC%A0%E5%9B%BE%E7%89%87%E5%90%88%E6%88%90%E4%B8%80%E4%BB%BDpdf%E6%96%87%E6%A1%A3%EF%BC%81/"&gt;这里&lt;/a&gt;, 知道了可以用pdfjam来做. 先要安装pdfjam, 然后:&lt;/p&gt;
&lt;p&gt;先将所有jpg文件重命名为pdf：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;rename 's/\.jpg$/\.pdf/' *.jpg&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;合成刚重命名的pdf文件为一份：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;pdfjoin $(ls *.pdf|sort -n) --outfile xx.pdf&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;后来看到pdfjam其实是在用latex, 想到其实也可以先自动生成一个tex文件然后再调用tex生成pdf... 不过既然有现成的软件就直接用吧!!&lt;/p&gt;
&lt;h2 id="mp3"&gt;合并mp3&lt;/h2&gt;
&lt;p&gt;超级简单的一条命令:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;cat *.mp3 &amp;gt; output.mp3&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;只要预先把文件按照想要的顺序编号即可
这个操作只是把这些文件前后连接起来, 可能是由于mp3文件格式的原因吧, 只要这么做了就和并完成了!! 而且速度快得惊人!!!&lt;/p&gt;
&lt;p&gt;不过有一点问题: 合并出来的mp3文件的信息(歌名, 艺术家之类)会是最后一个文件的信息... 当然这基本不影响使用~&lt;/p&gt;
&lt;h2 id="_1"&gt;批量压缩图片&lt;/h2&gt;
&lt;p&gt;使用convert命令, 好像是在ImageMagick里面.
参考&lt;a href="http://www.360doc.com/content/11/0704/16/2104556_131439876.shtml"&gt;这里&lt;/a&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="nv"&gt;images&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;ls *.JPG&lt;span class="sb"&gt;`&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;"resize images begining..."&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="k"&gt;for&lt;/span&gt; image in &lt;span class="nv"&gt;$images&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="k"&gt;do&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;convert &lt;span class="nv"&gt;$image&lt;/span&gt; -resize 50% &lt;span class="nv"&gt;$image&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;"resize &lt;/span&gt;&lt;span class="nv"&gt;$image&lt;/span&gt;&lt;span class="s2"&gt; to %50"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="k"&gt;done&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="nb"&gt;exit&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;然后就OK了... 顺便吐槽下gmail的附件大小限制!!...&lt;/p&gt;</summary><category term="linux"></category></entry></feed>